<html>
<head>
  <title>Canvas Flood Visualizer</title>
  <style>
    .container {
      border: 1px solid black;
      width: 500px;
      margin:100px auto;
    }
    .cell {
      display: inline-block;
      width: 5px;
      height: 5px;
      margin: 0;
    }
  </style>
</head>
<body>
  <div class="container"></div>

  <script src="/socket.io-min.js"></script>
  <script src="/jquery-min.js"></script>
  <script>
    $(document).ready(function() {
      var SIZE = 100;
      var DEFAULT_COLOR = "white";

      var container = $(".container");
      var cells = [];
      for (var y = 0; y < SIZE; y++) {
        var row = $("<div class='row'></div>");
        for (var x = 0; x < SIZE; x++) {
          var cell = $("<div class='cell'></div>");
          row.append(cell);
        }
        container.append(row);
        cells.push(cell);
      }
      
      function setColor(color, i) {
        cells[i].css({"background-color": color});
      }

      function render(data) {
        data.forEach(setColor);
      }

      function update(changes) {
        for (var i = 0, len = changes.length; i < len; i++) {
          var parts = changes.split(" ");
          var x = parts[0];
          var y = parts[1];
          var color = parts[2];
          setColor(color, SIZE * y + x)
        }
      }

      var socket = io("http://localhost:7777");
      socket.on("data", render);
      socket.on("changes", update);
    });
  </script>
</body>
</html>
