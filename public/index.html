<html>
<head>
  <title>Canvas Flood Visualizer</title>
  <style>
    .container {
      border: 1px solid black;
      width: 500px;
      margin:100px auto;
    }
    .cell {
      display: inline-block;
      width: 5px;
      height: 5px;
      margin: 0;
    }
  </style>
</head>
<body>
  <div class="container"></div>

  <script src="https://cdn.socket.io/socket.io-1.3.4.js"></script>
  <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
  <script>
    $(document).ready(function() {
      var SIZE = 100;
      var DEFAULT_COLOR = "white";

      var ct = $(".container");
      var cells = [];
      var colors = [];
      for (var y = 0; y < SIZE; y++) {
        var cellRow = [];
        var colorRow = [];
        var row = $("<div class='row'></div>");
        for (var x = 0; x < SIZE; x++) {
          var cell = $("<div class='cell'></div>");
          row.append(cell);
          cellRow.push(cell);
          colorRow.push(DEFAULT_COLOR);
        }
        ct.append(row);
        cells.push(cellRow);
        colors.push(colorRow);
      }
      function render(data) {
        for (var y = 0; y < SIZE; y++) {
          for (var x = 0; x < SIZE; x++) {
            var newColor = data[y] && data[y][x] || DEFAULT_COLOR;
            var oldColor = colors[y][x];
            if (newColor !== oldColor) {
              cells[y][x].css({"background-color": newColor});
            }
          }
        }
      }

      var socket = io("http://localhost:7777");
      socket.on("IMG", render);
    });
  </script>
</body>
</html>
